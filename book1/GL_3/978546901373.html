<!-- head part start -->
<html>
<head>
<title>Издательство "Питер": Электронный каталог</title>
<meta content="text/html; charset=windows-1251" http-equiv="Content-Type">
<link href="../css/class.css" rel="stylesheet" type="text/css">
</head>
<body  bgcolor="#FFFFFF" text="#333333"  link="#353A90" leftmargin="1" topmargin="1" marginwidth="1" marginheight="1">
<!-- это из нового -->
      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <table width="100%" border="0" cellspacing="0" cellpadding="0">

              <tr>
                <td bgcolor="282B99" width="3000" background="../images/10tbg.jpg">

<a href=http://shop.piter.com><img src="../images/slogo.gif" width="182" height="66" border="0"></a></td>

<td width="3"><img src="../images/sg0.gif" width="3" height="66"></td>
                <td width="137" bgcolor="282B99">
                  <table border="0" cellspacing="0" cellpadding="2" width="88"  align="center">
                    <tr>
                      <td class="small"><font color="#FFFFFF">всего книг</font></td>

                      <td class="small"><a href="http://shop.piter.com"><font color="#FFFFFF"><b>1544</b></font></a></td>
                    </tr>
                    <tr>
                      <td class="small"><font color="#FFFFFF">новинок</font></td>
                      <td class="small"><a href=http://shop.piter.com/display.phtml?new=yes><font color="#FFFFFF"><b>161</b></font></a></td>
                    </tr>
                    <tr>

                      <td class="small"><font color="#FFFFFF">бестселлеров</font></td>
                      <td class="small"><a href=http://shop.piter.com/display.phtml?bsell=yes><font color="#FFFFFF"><b>239</b></font></a></td>
                    </tr>
                  </table>
                </td>
                <td align="right" width="1" bgcolor="282B99"><img src="../images/sg1.gif" width="2" height="66"></td>
              </tr>
              <tr>

                <td colspan="4" background="../images/m_bg.gif">
                  <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                      <td width="435" align="left" nowrap><a href="../publishing/index.html"><img src="../images/publishing.gif" width="94" height="19" border="0"></a><img src="../images/rg_g.gif" width="5" height="19"><a href="../index.html"><img src="../images/katalog.gif" width="62" height="19" border="0"></a><img src="../images/rg_g.gif" width="5" height="19"><a href="../sbit/index.html"><img src="../images/sbit.gif" width="86" height="19" border="0"></a><img src="../images/rg_g.gif" width="5" height="19"><a href="../feedback/index.html"><img src="../images/feedback.gif" width="102" height="19" border="0"></a><img src="../images/rg_g.gif" width="5" height="19"></td>
                      <td align="right"><img src="../images/m_end.gif" width="2" height="19"></td>
                    </tr>
                  </table>
                </td>
              </tr>

            </table>
          </td>
        </tr><!-- конец шапки -->
      </table>
<!-- head part end -->
<!-- center part 3-col start -->
<table width="100%" border=0 cellpadding=0 cellspacing=0>
    <tr>
         <td width="5"></td>
         <td valign="top">

             <p><font class="kat1">Издание: Реестр Windows XP на 100 % (+CD)  </font></p>
		
<p><H3> Глава 8 </H3> 
<h2> Настройка оболочки </h2>
<ul><li>	ActiveX-объекты
</li><li>	Меню Пуск
</li><li>	Оболочка </li></ul>
В данной главе мы рассмотрим настройку Рабочего стола, меню Пуск, а также различных элементов пользовательского интерфейса (папок, значков файлов, дополнительных диалогов, списков MRU). Начнем с настроек стандартных ActiveX-объектов, с которыми мы сталкиваемся буквально каждый день.
<h3> ActiveX-объекты </h3>
Такие папки Windows, как Мой компьютер, Сетевое окружение, Панель управления, Назначенные задания и т. д., являются ActiveX-объектами. С одной стороны, они вносят разнообразие и выгодно отличаются от обычных папок. Однако с другой стороны, программисты Microsoft не создали никаких диалогов для настройки отображения этих ActiveX-объектов. В результате нельзя даже изменить их имя или значок. Основное неудобство заключается в том, что часто ActiveX-объекты появляются там, где их видеть не хотелось бы (например, не все хотят видеть значок Корзины на Рабочем столе). </p><p>
<u><b> Мой компьютер </b></u> </p><p>
Значок Мой компьютер является, пожалуй, самым используемым ActiveX-объектом, поэтому начнем данную главу именно с рассмотрения его настроек. </p><p>
<FONT SIZE=-1> <B>	ПРИМЕЧАНИЕ </B>
В данной главе не будет упоминаний о настройках, производимых в ветви реестра HKEY_CLASSES_ROOT\CLSID, так как выше уже рассматривалось, как изменить значок и подсказку, переименовать, а также скрыть ActiveX-объект. В данной главе описываются параметры оболочки, то есть настройки из ветвей реестра HKEY_CURRENT_USER и HKEY_LOCAL_MACHINE. </font></p><p>
Скрыть значок Мой компьютер или элементы, содержащиеся в окне, которое появляется при щелчке на данном значке (например, значки дисков, общих папок), можно большим количеством способов. </p><p>
Чтобы удалить какой-нибудь ActiveX-объект из списка содержимого значка Мой компьютер, нужно отредактировать ветвь реестра Software\Microsoft\Windows\CurrentVersion\ Explorer\HideMyComputerIcons (данная ветвь в корневом разделе HKEY_CURRENT_USER имеет больший приоритет, чем ее аналог в HKEY_LOCAL_MACHINE). Эта ветвь содержит параметры с именами, соответствующими CLSID-номерам ActiveX-объектов, которые не будут отображаться в папке Мой компьютер (наиболее часто используемые CLSID-номера ActiveX-объектов приведены в приложении к книге).
<ul><li>	Другим способом удаления ActiveX-объекта из списка содержимого окна Мой компьютер является редактирование ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\ Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace. Причем с помощью данной ветви можно не только удалить, но и добавить новый ActiveX-объект. В эту ветвь входят подразделы с именами, соответствующими CLSID-номерам ActiveX-объектов, которые будут отображаться в содержимом значка Мой компьютер. По умолчанию содержимым значка Мой компьютер является набор общих папок. Если вас это не устраивает, то удаляйте данные папки, используя эту ветвь реестра. </p><p>
	<FONT SIZE=-1> <B> ПРИМЕЧАНИЕ </B> <BR>
Общие папки можно также удалить при помощи параметра DWORD-типа NoSharedDocuments, расположенного в ветви реестра SOFTWARE\Microsoft\ Windows\CurrentVersion\policies\Explorer. </font></p><p>
</li><li>	Можно удалить значок Мой компьютер и заблокировать флажок, добавляющий значок Мой компьютер на Рабочий стол (этот флажок расположен на вкладке Общие окна Элементы рабочего стола, которое появляется при нажатии кнопки Настройка рабочего стола на вкладке Рабочий стол окна Свойства: Экран). Для этого нужно добавить параметр DWORD-типа {20D04FE0-3AEA-1069-A2D8-08002B30309D} со значением, равным 1, в раздел реестра HKEY_CURRENT_USER\Software\Microsoft\Windows\ CurrentVersion\Policies\NonEnum. Таким же образом можно запретить использование любого ActiveX-объекта.
</li><li>	Чтобы удалить из Проводника и содержимого окна Мой компьютер значок какого-нибудь диска, нужно воспользоваться параметром DWORD-типа NoDrives, расположенным в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\ Explorer. Значением данного параметра являются управляющие биты, каждый из которых определяет, будет ли отображаться значок какого-нибудь диска. Например, чтобы скрыть диск A:, битовая маска данного параметра должна быть равна 0х00000001; чтобы скрыть B: — 0х00000002; чтобы скрыть C: — 0х00000004; чтобы скрыть D: — 0х00000008 и т. д. (как видите, используется арифметическая прогрессия). Если нужно скрыть несколько дисков, достаточно сложить их битовые маски.
</li><li>	Можно не скрывать значки дисков (тем более что после скрытия ими все равно можно пользоваться с помощью командной строки), а просто запретить к ним доступ данному пользователю. Для этого предназначен DWORD-параметр NoViewOnDrive, расположенный в ветви реестра Software\Microsoft\Windows\ CurrentVersion\Policies\Explorer. Значение данного параметра также является битовой маской, и каждый его бит соответствует одному диску, как и в предыдущем параметре. </li></ul>
Рассмотрим, как скрыть команды контекстного меню значка Мой компьютер с помощью параметров реестра.
<ul><li>	Команда Управление позволяет вызвать оснастку Управление компьютером, с помощью которой можно, например, просмотреть журнал событий и отредактировать список учетных записей пользователей. В принципе, это достаточно нужная и полезная команда, но если вы создадите собственную оснастку и будете пользоваться только ею, то данная команда может вам не понадобиться. Чтобы удалить из контекстного меню значка Мой компьютер команду Управление, следует присвоить DWORD-параметру NoManageMyComputerVerb значение, равное 1. Этот параметр расположен в ветви реестра Software\Microsoft\Windows\ CurrentVersion\Policies\Explorer. </p><p>
Обратите внимание, что удаление команды Управление контекстного меню значка Мой компьютер не влияет на работу самой оснастки compmgmt.msc — ею пользоваться будет все еще можно.
</li><li>	Команды Подключить сетевой диск и Отключить сетевой диск предназначены для переопределения местонахождения какой-либо папки таким образом, чтобы она считалась новым диском. Согласитесь, гораздо удобнее, например, пользоваться диском Z: вместо того, чтобы работать с каталогом \\z\za\qwer\ffreq\f. Но если данные команды вам не нужны, просто создайте в ветви реестра Software\ Microsoft\Windows\CurrentVersion\Policies\Explorer параметр DWORD-типа NoNetConnectDisconnect и присвойте ему значение 1. Обратите внимание, что при этом исчезнут и аналогичные команды меню Сервис окна любой папки.
</li><li>	Команда Свойства позволяет открыть окно Свойства системы, с помощью которого можно выполнить различные настройки работы системы. Чтобы удалить данную команду из контекстного меню значка Мой компьютер, следует присвоить DWORD-параметру NoPropertiesMyComputer, который расположен в ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer, значение 1. </li></ul>
<u><b> Рабочий стол </b></u> </p><p>
Рабочий стол является, пожалуй, самым объемным ActiveX-объектом. Действительно, как это ни странно, но Рабочий стол тоже считается ActiveX-объектом, причем довольно интересным с точки зрения возможностей его настройки. </p><p>
В основном все настройки Рабочего стола сводятся к скрытию или отображению какого-нибудь элемента, расположенного на нем. Причем если для значка Мой компьютер скрываются только ActiveX-объекты, то с Рабочим столом все несколько сложнее. </p><p>
Чтобы удалить с Рабочего стола какой-нибудь ActiveX-объект, нужно отредактировать ветвь реестра SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons. Эта ветвь содержит параметры с именами, соответствующими CLSID-номерам ActiveX-объектов, которые не отображаются на Рабочем столе (список наиболее используемых CLSID-номеров ActiveX-объектов приведен в приложении 2). Можно сказать, что данная ветвь не отличается от используемой для настройки значка Мой компьютер (см. выше). </p><p>
Для настройки ActiveX-объектов, отображаемых на Рабочем столе, предназначен еще один подраздел реестра  — HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\ CurrentVersion\Explorer\Desktop\NameSpace. Эта ветвь содержит подразделы с именами, соответствующими CLSID-номерам ActiveX-объектов, которые будут присутствовать на Рабочем столе. </p><p>
	<FONT SIZE=-1> <B> ВНИМАНИЕ </B> <BR>
При редактировании данной ветви следует быть осторожным — ни в коем случае не удаляйте подразделы {e17d4fc0-5564-11d1-83f2-00a0c90dc849} и {1f4de370-d627-11d1-ba4f-00a0c91eedba}. Они определяют возможность работы окна Результаты поиска, и если вы удалите данные подразделы, то это окно не будет работать. </font></p><p>
Чтобы скрыть с Рабочего стола ActiveX-объект Сетевое окружение, следует назначить параметру DWORD-типа NoNetHood, который расположен в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\Explorer, значение 1. </p><p>
Для скрытия с Рабочего стола значка Internet Explorer нужно назначить параметру DWORD-типа NoInternetIcon, расположенному в ветви реестра Software\Microsoft\ Windows\CurrentVersion\Policies\Explorer, значение 1. </p><p>
Чтобы полностью скрыть содержимое Рабочего стола (как ActiveX-объекты, так и другие файлы и ярлыки, расположенные на нем), следует назначить параметру DWORD-типа HideIcons, который находится в ветви Software\Microsoft\Windows\ CurrentVersion\Explorer\Advanced, значение 1. </p><p>
Если предыдущее действие можно также выполнить при помощи команды Упорядочить значки?Отображать значки рабочего стола контекстного меню Рабочего стола, то параметр DWORD-типа NoDesktop, который находится в ветви Software\Microsoft\ Windows\CurrentVersion\Policies\Explorer, нельзя отредактировать при помощи диалогов Windows. По этой причине если вы скроете значки с Рабочего стола, то пользователи самостоятельно не смогут их отобразить. Обратите внимание, что при этом исчезнет и контекстное меню Рабочего стола. </p><p>
Можно скрыть из контекстного меню Рабочего стола команды Отображать значки рабочего стола, Закрепить веб-элементы на рабочем столе и Мастер очистки рабочего стола, которые входят в подменю команды Упорядочить значки. Для этого следует назначить параметру DWORD-типа NoActiveDesktopChanges, расположенному в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\Explorer, значение 1. </p><p>
Чтобы показать на Рабочем столе версию используемой операционной системы (рис. 8.1), нужно назначить параметру DWORD-типа PaintDesktopVersion, который расположен в ветви системного реестра HKEY_CURRENT_USER\Control Panel\Desktop, значение 1. </p><p>
 
<img src=/contents/978546901373/1.jpg></p><p>
<b>Рис. 8.1. </b>Версия Windows в нижней части Рабочего стола</p><p>
Мы уже рассматривали некоторые параметры реестра, предназначенные для изменения фонового рисунка Рабочего стола (см. разд. «Окно Свойства: Экран» гл. 7). Опишем еще один параметр — Wallpaper, который имеет строковый тип, находится в ветви реестра HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\ system и определяет путь к изображению Рабочего стола. При этом пользователь не имеет права изменять этот фоновый рисунок при помощи окна Свойства: Экран. </p><p>
Если Рабочий стол представлен как Active Desktop, то  шестой бит пятого байта параметра двоичного типа ShellState, который находится в ветви HKEY_CURRENT_USER\ Software\Microsoft\Windows\CurrentVersion\Explorer, равен 1. </p><p>
Координаты расположения значков на Рабочем столе описаны в ветви реестра HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Streams\Desktop. Если расположение значков на Рабочем столе настроено идеально, то рекомендуется с помощью окна Разрешения назначить этому подразделу права только на чтение. Теперь вы не сможете нечаянно изменить расположение значков — после смены сеанса оно будут восстановлено. </p><p>
<u><b>Корзина</b></u></p><p>
Корзина — последнее пристанище удаленных объектов — также является ActiveX-объектом. Настройки Корзины хранятся в ветви реестра HKEY_LOCAL_MACHINE\ SOFTWARE\Microsoft\ Windows\CurrentVersion\Explorer\BitBucket.
<ul><li>	NukeOnDelete — если значение этого DWORD-параметра равно 1, то файлы будут удаляться сразу после помещения в Корзину.
</li><li>	Percent — данный DWORD-параметр определяет предельный объем Корзины в процентах от объема жесткого диска.
</li><li>	UseGlobalSettings — если значение этого DWORD-параметра равно 1, то будут использоваться глобальные настройки Корзины (единые для всех дисков). </li></ul>
Чтобы запретить команду Свойства контекстного меню Корзины, нужно задать параметру DWORD-типа NoPropertiesRecycleBin, расположенному в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\Explorer, значение 1. </p><p>
Когда мы рассматривали ActiveX-объект, принадлежащий Корзине, мы описывали настройку значков для полной и пустой Корзины (см. подразд. «Подразделы ActiveX» разд. «OLE- и ActiveX-объекты» гл. 5). Эти данные используются для определения значка Корзины лишь при загрузке оболочки. Сведения о текущем значке Корзины хранятся в ветви реестра HKEY_CURRENT_USER\Software\Microsoft\ Windows\CurrentVersion\Explorer\CLSID. Данная ветвь содержит подраздел с именем, соответствующим CLSID-номеру Корзины — {645FF040-5081-101B-9F08-00AA002F954E}. Этот подраздел определяет параметры, которые будет использовать система в текущем сеансе работы. Причем в этом подразделе могут содержаться все параметры и подразделы, используемые в ветви реестра HKEY_CLASSES_ROOT\CLSID\{645FF040-5081-101B-9F08-00AA002F954E}. Среди этих подразделов, как вы уже знаете, может присутствовать подраздел DefaultIcon, содержимым которого являются три строковых параметра — параметр (По умолчанию), Empty, Full. Параметр (По умолчанию) определяет путь и имя значка, который используется в данный момент, параметр Empty задает значок для пустой Корзины, а параметр Full — для полной. Вы можете установить свой значок для пустой и полной Корзины. </p><p>
	<FONT SIZE=-1><B>ПРИМЕЧАНИЕ</B><BR>
В описанном подразделе можно изменять параметры не только Корзины, но и других ActiveX-объектов. </font></p><p>
<u><b>Панель управления</b></u></p><p>
Изначально Панель управления предназначалась для администрирования компьютера, а начиная с Windows 2000, для администрирования используется консоль mmc и ее оснастки. Хотя некоторые элементы администрирования компьютера еще есть на Панели управления. В любом случае, если вы на «ты» с реестром, то только от вас зависит, что будет находиться на Панели управления. </p><p>
Есть несколько вариантов отображения либо скрытия ActiveX-объектов с Панели управления. </p><p>
Самый общий из них подобен методу, используемому для скрытия/отображения ActiveX-объектов на Рабочем столе и в окне Мой компьютер — использование ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ Explorer\ControlPanel\NameSpace. Чтобы добавить новый либо удалить существующий ActiveX-объект с Панели управления, нужно в эту ветвь реестра добавить или удалить из нее подраздел с именем, соответствующим CLSID-номеру необходимого объекта. </p><p>
Однако самое главное, что содержится на Панели управления, — это CPL-файлы (собственно, именно для их хранения создавалась Панель управления). Их тоже можно скрыть, причем это можно сделать двумя способами. Первый заключается в редактировании ветви реестра HKEY_CURRENT_USER\Control Panel\don't load. Если вы хотите скрыть какой-нибудь CPL-файл, например main.cpl (определяет окно Свойства: Мышь), то создайте в данной ветви параметр строкового типа с именем, соответствующим названию CPL-файла (в нашем примере параметр будет называться main.cpl), и присвойте ему значение no. </p><p>
Это довольно примитивный способ, ведь любой пользователь сможет запустить Редактор реестра и удалить все параметры, которые вы запретили в данной ветви (если, конечно, не запретить пользователю полный доступ к этой ветви реестра). Второй способ — редактирование ветви реестра HKEY_CURRENT_USER\Software\ Microsoft\Windows\CurrentVersion\Policies\Explorer. С помощью этой ветви можно не только запретить отображение отдельных CPL-файлов, но и, наоборот, разрешить отображение только указанных вами CPL-файлов. Чтобы запретить определенные CPL-файлы, создайте в данной ветви реестра параметр DWORD-типа DisallowCpl и присвойте ему значение 1. Чтобы разрешить только указанные вами CPL-файлы, создайте в этой ветви параметр DWORD-типа RestrictCpl и присвойте ему значение 1. После этого создайте в данной ветви подраздел, в котором определите разрешенные или запрещенные CPL-файлы. Если вы запрещаете CPL-файлы, то создайте подраздел DisallowCpl, а если разрешаете, то подраздел RestrictCpl. Чтобы указать необходимые CPL-файлы, создайте в этих подразделах строковые параметры с именами в формате 1, 2, 3, 4 и т. д. и значениями, соответствующими именам CPL-файлов (рис. 8.2). </p><p>
В Windows XP Панель управления приобрела новый интерфейс — вид по категориям. Чтобы запретить переключаться к виду по категориям, присвойте DWORD-параметру ForceClassicControlPanel, который находится в ветви реестра Software\ Microsoft\Windows\CurrentVersion\Policies\Explorer, значение 1. </p><p>
 
<img src=/contents/978546901373/2.jpg></p><p>
	</p><p align=center><I>а</I></p><p>
 
<img src=/contents/978546901373/3.jpg></p><p>
	</p><p align=center><I>б</I></p><p>
<b>Рис. 8.2. </b> Значок Выполнить, добавленный на Панель управления (а) и соответствующие параметры реестра (б) </p><p>
<h3>Другие объекты</h3>
В данном разделе рассмотрим настройки других ActiveX-объектов. Возможно, они не такие популярные, как рассмотренные выше, но все же не менее интересные.
<ul><li>	Чтобы удалить или добавить какой-либо ActiveX-объект в окно Сетевое окружение, нужно использовать ветвь реестра HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ Windows\CurrentVersion\Explorer\NetworkNeighborhood\NameSpace. Эта ветвь содержит подразделы с именами, соответствующими CLSID-номерам ActiveX-объектов, которые будут отображаться в окне Сетевое окружение.
</li><li>	Чтобы удалить или добавить какой-либо ActiveX-объект в окно удаленного компьютера, нужно использовать ветвь реестра HKEY_LOCAL_MACHINE\SOFTWARE\ Microsoft\Windows\CurrentVersion\Explorer\RemoteComputer\NameSpace. Эта ветвь содержит подразделы с именами, соответствующими CLSID-номерам ActiveX-объектов, которые будут отображаться в окне удаленного компьютера. </p><p>
По умолчанию в этой ветви хранятся два подраздела — {2227A280-3AEA-1069-A2DE-08002B30309D} и {D6277990-4C6A-11CF-8D87-00AA0060F5BF}. Первый из них отвечает за автоматическую проверку наличия на удаленных компьютерах принтеров, а второй — назначенных заданий. Эти компоненты некорректно работают с компьютерами, на которых установлены операционные системы Windows 98, вследствие чего скорость открытия содержимого данных машин падает. По этой причине, если вам не нужны эти функции (и в сети есть компьютеры с Windows 98), лучше удалить данные подразделы.
</li><li>	Чтобы скрыть команду Свойства из контекстного меню папки Мои документы, присвойте DWORD-параметру NoPropertiesMyDocuments, расположенному в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\Explorer, значение 1. </li></ul>
<u><b>Меню Пуск</b></u></p><p>
Меню Пуск — важный элемент интерфейса Windows XP. Однако иногда оно разрастается от различных, порой совершенно ненужных, команд и начинает занимать чуть ли не половину экрана. Как вы догадываетесь, при помощи реестра с этим можно справиться. </p><p>
Все параметры, описанные в этом разделе, расположены в ветви Software\Microsoft\ Windows\CurrentVersion\Explorer\Advanced. Если же они находятся в другой ветви, об этом будет сказано заранее. </p><p>
В Windows XP меню Пуск имеет два варианта интерфейса: классический (то есть такой, как использовался в предыдущих версиях Windows) и новый (стиль Windows XP). По этой причине описание меню Пуск разбито на три части. </p><p>
В первой части рассматриваются параметры, настраиваемые только для классического меню Пуск. Во второй — настройки нового меню Пуск. В третьей — общие настройки, которые применяются как в классическом, так и в новом меню Пуск. В свою очередь, каждая часть условно разбита на две — в первой рассказано о настройках меню, а во второй — об ограничениях, которые можно на них наложить. </p><p>
<u><b>Классическое меню</b></u></p><p>
Классическое меню Пуск в Windows XP может содержать такие папки, как Панель управления, Мои документы, Мои рисунки, Принтеры и факсы и т. д. Отображение этих папок можно настраивать: они могут показываться либо как список, элементами которого будет его содержимое, либо как ссылка на окно папки. Эта возможность реализуется при помощи строковых параметров, значением которых может быть либо YES (будет отображаться список) либо NO (будет показываться ссылка). Рассмотрим некоторые параметры:
<ul><li>	CascadeControlPanel — описывает поведение значка Панель управления;
</li><li>	CascadeMyDocuments — Мои документы;
</li><li>	CascadeMyPictures — Мои рисунки;
</li><li>	CascadeNetworkConnections — Сетевые подключения;
</li><li>	CascadePrinters — Принтеры и факсы. </li></ul>
Значения этих параметров можно изменить и при помощи диалогов Windows. Для этого нужно нажать кнопку Настроить на вкладке Меню "Пуск" диалога Свойства панели задач и меню "Пуск" (оно появляется при щелчке правой кнопкой мыши на Панели задач или на кнопке Пуск и выборе команды Свойства). </p><p>
Некоторые элементы классического меню Пуск, например папку Администрирование или меню Избранное, можно скрыть. Для этого следует присвоить значение NO следующим DWORD-параметрам:
<ul><li>	StartMenuAdminTools — скрыть подменю Администрирование;
</li><li>	StartMenuFavorites — Избранное;
</li><li>	StartMenuRun — Выполнить;
</li><li>	StartmenuLogoff — скрыть команду Завершение сеанса. </li></ul>
Следующие DWORD-параметры реестра также заслуживают внимания. Если их значения равны 0, то:
<ul><li>	IntelliMenus — не будет использоваться сокращенное меню Пуск (то есть не будут скрываться команды, к которым вы редко обращаетесь);
</li><li>	Start_LargeMFUIcons — будут показываться маленькие значки в меню Пуск;
</li><li>	StartMenuChange — будет отключена возможность перетаскивания в меню Пуск. </li></ul>
Специальных ограничений для классического меню Пуск очень мало. Обратите внимание, что в данном случае имеются в виду именно специфические ограничения для классического меню, общие ограничения будут описаны ниже в разд. «Общие параметры классического и нового меню Пуск». Если вы привыкли к классическому меню, то можете запретить изменять его интерфейс на новый. Для этого следует задать DWORD-параметру NoSimpleStartMenu, расположенному в ветви реестра SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer, значение 1. При этом будет скрыта возможность переключения на новое меню Пуск при помощи вкладки Меню "Пуск" окна Свойства панели задач и меню "Пуск".</p><p>
Чтобы отредактировать список команд подменю Найти меню Пуск, используется ветвь реестра HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ Explorer\FindExtensions\Static. В этой ветви могут находиться следующие подразделы.
<ul><li>	ShellSearch — параметр (По умолчанию) этого подраздела определяет команду Файлы и папки подменю Найти меню Пуск. В этом подразделе могут содержаться подразделы с именами 0, 1, 2 и т. д. Параметр (По умолчанию) этих подразделов определяет название ссылки, используемой в окне Результаты поиска для перехода в определенный режим. Если удалить один из этих подразделов, то исчезнет и ссылка на соответствующий режим поиска.
</li><li>	WabFind — параметр (По умолчанию) этого подраздела определяет команду Людей подменю Найти меню Пуск.
</li><li>	WebSearch — параметр (По умолчанию) этого подраздела определяет команду В Интернете подменю Найти меню Пуск. </li></ul>
Если значение параметра NoSmMyPictures равно 1, то будет убрано из подменю Пуск->Документы подменю Мои рисунки. </p><p>
Подменю Настройка содержит команды быстрого вызова Панели управления, папки Принтеры и факсы и др. Для данного подменю предназначены следующие DWORD-параметры.
<ul><li>	NoControlPanel — если значение этого параметра равно 1, то из меню Пуск будет убрана команда Настройка->Панель управления и запрещен запуск команды control.exe и CPL-файлов.
</li><li>	NoSetFolders — если значение данного параметра равно 1, то из меню Пуск будут удалены команды Настройка->Принтеры и факсы, а также Настройка->Панель управления. </p><p>
	<FONT SIZE=-1><B>ПРИМЕЧАНИЕ</B><BR>
Система позволяет также запретить установку принтеров, использующих драйверы, которые работают в режиме ядра (неправильно написанные, такие драйверы могут привести к отказу системы). Для этого нужно присвоить DWORD-параметру KMPrintersAreBlocked, расположенному в ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\ Printers, значение 0. </p><p>
Кроме этого, данная ветвь может содержать подраздел Wizard, хранящий DWORD-параметр Downlevel Browse. Если его значение будет равно 0, то при установке принтера с помощью мастера на втором шаге (при установке переключателя в положение Сетевой принтер или принтер, подключенный к другому компьютеру) исчезнет кнопка Обзор. </p><p>
Некоторые настройки принтеров хранятся в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\Explorer. Например, кроме рассмотренных выше, там могут содержаться DWORD-параметры NoAddPrinter и NoDeletePrinter. Первый из них при значении 1 запрещает добавлять новый принтер при помощи мастера, а второй — удалять созданные принтеры. </font></p><p>
</li><li>	NoSetTaskbar — если значение данного параметра равно 1, то команда Настройка->Панель задач и меню "Пуск" будет убрана из меню Пуск. </li></ul>
<u><b>Новое меню Windows XP</b></u></p><p>
В новом меню Пуск программисты Microsoft попытались свести к минимуму количество щелчков кнопками и движений мышью, необходимых пользователю для открытия часто используемых программ. С одной стороны, это им удалось — теперь наиболее используемые программы выносятся в меню Пуск, а не в его подразделы. Но с другой стороны, это приводит к необычайному разрастанию меню Пуск. </p><p>
Конечно, новое меню Пуск удобнее своего предшественника, однако чтобы оно стало действительно удобным, нужно потратить довольно много времени на его настройку для себя. Тем не менее это время не будет потрачено зря, после этого новое меню Пуск будет вызывать у вас только положительные ощущения. </p><p>
Начнем настройку нового меню Пуск, как и классического, с папок. В данном случае один параметр DWORD-типа отвечает за то, будет ли показываться папка и как она будет отображаться. Параметр может иметь три значения: равное 0 скрывает папку из меню Пуск; равное 1 отображает ее как ссылку; равное 2 — как подменю. Рассмотрим некоторые из этих параметров:
<ul><li>	Start_AdminTools — определяет настройки папки Администрирование;
</li><li>	Start_ShowControlPanel — Панель управления;
</li><li>	Start_ShowMyComputer — Мой компьютер;
</li><li>	Start_ShowMyDocs — Мои документы;
</li><li>	Start_ShowMyMusic — Моя музыка;
</li><li>	Start_ShowMyPics — Мои рисунки;
</li><li>	Start_ShowNetConn — Сетевые подключения;
</li><li>	Start_ShowNetPlaces — Сетевое окружение;
</li><li>	Start_ShowPrinters — Принтеры и факсы. </li></ul>
Кроме папок, можно скрыть и некоторые другие элементы нового меню Пуск. В этом случае также используются параметры DWORD-типа, но теперь они могут принимать только два значения: равное 0 скрывает данный элемент меню Пуск, а равное 1 — отображает:
<ul><li>	Start_ShowHelp — меню Справка;
</li><li>	Start_ShowOEMLink — ссылку Производитель;
</li><li>	Start_ShowRun — команду Выполнить;
</li><li>	Start_ShowSearch — команду Найти. </li></ul>
Рассмотрим другие DWORD-параметры настройки нового меню Пуск, которые заслуживают внимания:
<ul><li>	Start_AutoCascade — если значение этого параметра равно 1, то подменю меню Пуск будут автоматически раскрываться при наведении и задержке указателя мыши над ними;
</li><li>	Start_EnableDragDrop — если значение этого параметра равно 0, то перетаскивание в меню Пуск будет отключено;
</li><li>	Start_NotifyNewApps — если значение этого параметра равно 0, то в меню Пуск не будут подсвечиваться недавно установленные программы;
</li><li>	Start_ScrollPrograms — если значение этого параметра равно 0, то будет запрещено использование прокрутки для подменю Все программы меню Пуск;
</li><li>	GreyMSIAds — если значение этого параметра равно 1, то частично установленные программы1 будут отображаться в подменю Все программы серым цветом. В отличие от рассмотренных выше параметров, этот расположен в ветви реестра Software\Microsoft\Windows\CurrentVersion\Policies\Explorer. </li></ul>
Если значение параметра NoControlPanel равно 1, то из меню Пуск будет убрана команда Панель управления. </p><p>
Все параметры, описанные ниже, расположены в ветви реестра Software\Microsoft\ Windows\CurrentVersion\Policies\Explorer и имеют тип DWORD.
<ul><li>	NoStartMenuMFUprogramsList — если значение этого параметра равно 1, то из меню Пуск будет удален список часто используемых программ (расположен в меню Пуск слева).
</li><li>	NoStartMenuMorePrograms — если значение этого параметра равно 1, то из меню Пуск будет удалена команда Все программы.
</li><li>	NoStartMenuPinnedList — если значение этого параметра равно 1, то из меню Пуск будет удален фиксированный список программ и значки Интернет и Электронная почта. Также будет удалена команда Закрепить в меню Пуск из контекстного меню исполняемых файлов.
</li><li>	NoStartMenuSubfolders — если значение этого параметра равно 1, то из верхней части меню Пуск->Все программы будут удалены ссылки на подкаталоги и файлы.
</li><li>	NoUserNameInStartMenu — если значение этого параметра равно 1, то из меню Пуск будет удалено имя пользователя. </li></ul>
На рис. 8.3 показан результат применения описанных параметров реестра. </p><p>
Рассмотрим, как наложить ограничения на изменение настроек другими пользователями. Конечно, если вы являетесь единственным пользователем компьютера, то можете смело пропустить эту информацию, но если, например, у вас есть маленький братик или сестричка…</p><p>
Все параметры, описанные ниже, расположены в ветви реестра Software\Microsoft\ Windows\CurrentVersion\Policies\Explorer и имеют тип DWORD.
<ul><li>	NoStartMenuNetworkPlaces — если значение этого параметра равно 1, то из меню Пуск будет удален элемент Сетевое окружение и запрещено редактирование соответствующего флажка на вкладке Дополнительно окна настройки меню Пуск. </p><p>
 
<img src=/contents/978546901373/4.jpg></p><p>
<b>Рис. 8.3. </b> Результат изменения меню Пуск с помощью параметров реестра</p><p>
</li><li>	ForceStartMenuLogoff — если значение этого параметра равно 1, то будет блокирована команда Выход из системы меню Пуск и запрещено включение ее в состав меню.
</li><li>	NoNetworkConnections — если значение этого параметра равно 1, то сетевые подключения в меню Пуск будут скрыты. </li></ul>
<u><b>Общие параметры классического и нового меню Пуск</b></u></p><p>
Windows XP позволяет разрешить или запретить использование прокрутки в меню Пуск. Для этого нужно обратиться к ветви реестра Software\Microsoft\Windows\ CurrentVersion\Explorer\Advanced. Если значение параметра StartMenuScrollPrograms равно NO, то в подменю Программы меню Пуск не будет использоваться прокрутка и строки, которые не поместились в раздел Программы, будут перемещены в новый подраздел. </p><p>
Порядок расположения команд в меню Пуск определяется в ветви реестра HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder. В этой ветви хранятся подразделы, определяющие названия подменю, а также используемый вид меню Пуск. В этих подразделах содержатся параметры двоичного типа Order, которые и задают порядок следования команд в соответствующем меню. </p><p>
Рассмотрим ограничения, которые можно установить на любое меню Пуск. Параметры, описанные ниже, расположены в ветви реестра Software\Microsoft\Windows\ CurrentVersion\Policies\Explorer. </p><p>
Команда Windows Update позволяет обновить Windows через Интернет. Если задать параметру NoWindowsUpdate значение 1, то данная команда будет убрана из меню Пуск. </p><p>
Подменю Избранное содержит список ссылок из папки Избранное. Если значение DWORD-параметра NoFavoritesMenu равно 1, то подменю Избранное будет убрано из меню Пуск. </p><p>
Подменю Документы (или Недавние документы при оформлении меню Пуск в стиле Windows XP) содержит 15 ссылок на документы, которые использовались на данном компьютере в последнее время. Для данного списка предназначены следующие DWORD-параметры.
<ul><li>	NoRecentDocsMenu — этот параметр применялся еще в Windows 9x. Если его значение равно 1, то подменю Недавние документы будет убрано из меню Пуск.
</li><li>	MaxRecentDocs — определяет количество файлов, которые будут отображаться в списке Недавние документы (нужно вводить значение, большее на единицу, чем необходимое вам количество пунктов подменю). По умолчанию его значение равно 15. </li></ul>
Чтобы удалить строку Мои документы из меню Пуск, следует назначить параметру NoSmMyDocs значение 1. </p><p>
Если значение DWORD-параметра NoFind равно 1, то подменю Найти (или команда Поиск меню Пуск стиля Windows XP) будет убрано из меню Пуск, а также не будет работать сочетание клавиш Windows+F. </p><p>
Для команды Справка и поддержка предназначены следующие параметры.
<ul><li>	Чтобы удалить команду Справка и поддержка из меню Пуск, следует задать DWORD-параметру NoSmHelp значение 1.
</li><li>	С отображением справки связан еще один интересный параметр — HelpQualifiedRootDir. Этот параметр строкового типа расположен в ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\System и содержит пути к каталогам, в которых будет запрещено открывать файлы справки с помощью программы winhelp. Если данный параметр не описан, то команду winhelp можно выполнять для любых папок. Этот параметр работает, только если установлен Internet Explorer не ниже шестой версии.
</li><li>Можно также определить имена исполняемых программ, которые нельзя будет вызывать из справки. Для этого используется параметр строкового типа DisableInHelp, расположенный в той же ветви, что и предыдущий. Названия нескольких программ указываются через запятую.
</li><li>	Чтобы скрыть раздел Знаете ли вы? в окне Центр справки и поддержки, необходимо DWORD-параметру Headlines, расположенному в ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\PCHealth\HelpSvc, присвоить значение, равное 0.
</li><li>	Чтобы запретить возможность поиска информации в базе знаний Microsoft, а также скрыть параметры справки, которые задают эту возможность, нужно присвоить DWORD-параметру MicrosoftKBSearch, расположенному в той ветви, что и предыдущий, значение 0. </li></ul>
	<FONT SIZE=-1><B>ПРИМЕЧАНИЕ</B><BR>
Настройки окна Центр справки и поддержки находятся в ветви реестра SOFTWARE\Microsoft\PCHealth\HelpCtr. </font></p><p>
Команда Выполнить вызывает окно Запуск программы, с помощью которого можно запустить программу, перейти к каталогу или странице в Интернете. Если значение параметра NoRun равно 1, то команда Выполнить будет убрана из меню Пуск, а также не будет работать сочетание клавиш Windows+R. </p><p>
Для команды Завершение сеанса (или Выход из системы при оформлении меню Пуск в стиле Windows XP) предназначены следующие параметры.
<ul><li>	StartmenuLogoff — если значение этого DWORD-параметра равно 1, то для пользователя будет заблокирована возможность удаления команды Выход из системы в меню Пуск.
</li><li>	NoLogOff — данный параметр применялся еще в Windows 9x. Если его значение равно 1, то команда Выход из системы будет скрыта из диалога завершения работы Windows. </li></ul>
Если значение DWORD-параметра NoClose равно 1, то из меню Пуск будет удалена команда Выключить компьютер (или Выключение при оформлении меню Пуск в стиле Windows XP). </p><p>
Если параметру NoChangeStartMenu задать значение 1, то будет отключена возможность перетаскивания в меню Пуск. </p><p>
Cодержимое папки %systemdrive%\Documents and Settings\All Users\ Главное меню не будет участвовать в построении меню Пуск, если значение параметра NoCommonGroups равно 1. </p><p>
<u><b>Построение вкладки Меню "Пуск" окна Свойства панели задач и меню "Пуск"</b></u></p><p>
Элементы вкладки Меню "Пуск" окна Свойства панели задач и меню "Пуск" можно настраивать. Списки в окнах, появляющихся при нажатии кнопки Настроить данной вкладки, строятся на основе ветви реестра HKEY_LOCAL_MACHINE\SOFTWARE\ Microsoft\Windows\CurrentVersion\Explorer\StartMenu. Мы не будем рассматривать данную ветвь, так как она практически аналогична содержимому ветви реестра, отвечающей за построение вкладки Вид окна Свойства папки (см. гл. 7). Для доказательства приведу рис. 8.4. </p><p>

<img src=/contents/978546901373/5.jpg></p><p>
	</p><p align=center><I>а</I></p><p>

<img src=/contents/978546901373/6.jpg>
	</p><p align=center><I>б</I></p><p>
<b>Рис. 8.4. </b> Список Дополнительные параметры меню "Пуск" окна Настройка классического меню "Пуск" (а) и соответствующие параметры (б)
 </p>

         </td>
         <td valign="top" width="190">

    <table width="190" border="0" cellspacing="0" cellpadding="0">

<tr><td colspan="3"><img src="../images/0.gif" width="190" height="3"></td></tr>

       <tr>
          <td><img src="../images/b11.gif" width="4" height="4"></td>
          <td><img src="../images/btop.gif" width="182" height="4"></td>
          <td><img src="../images/b12.gif" width="4" height="4"></td>
        </tr>
        <tr>
          <td background="../images/b1l.gif"><img src="../images/0.gif" width="4" height="2"></td>
          <td> <!-- начали наполнение ПЛАШКИ 2  -->

            <table border="0" cellpadding="2" cellspacing="0" width="182">
              <tr bgcolor="f7f7f7">
<td><table border=0 cellpadding="0" cellspacing="0" width="90%">
                <td><img src="../images/pnav.gif" width="19" height="17"></td><td width="90%" class="nm" align="center">Книги</td></tr></table>
               </td>
              </tr>
              <tr>
                <td class="small">
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-101.html">

Компьютеры    </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-108.html">
Экономика     </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-104.html">
Психология    </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-120.html">
Популярная психология  </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-110.html">
Юридическая  </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-150.html">
Периодика  </a><br>

<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-102.html">
Медицина      </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-103.html">
Оздоровление  </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-106.html">
Образование   </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-107.html">
Воспитание    </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-125.html">
Домоводство  </a><br>
<img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../theme/index-130.html">
Гуманитарная  </a><br>

                </td>
              </tr>
             </table>
          </td><!-- закончили  наполнение ПЛАШКИ 2  -->
          <td background="../images/b1r.gif"><img src="../images/0.gif" width="4" height="2"></td>
        </tr>
        <tr>
          <td><img src="../images/b21.gif" width="4" height="4"></td>
          <td><img src="../images/bbot.gif" width="182" height="4"></td>

          <td><img src="../images/b22.gif" width="4" height="4"></td>
        </tr>
      </table>
<!--   ***************  -->
    <table width="190" border="0" cellspacing="0" cellpadding="0">
<tr><td colspan="3"><img src="../images/0.gif" width="190" height="3"></td></tr>

       <tr>
          <td><img src="../images/b11.gif" width="4" height="4"></td>
          <td><img src="../images/btop.gif" width="182" height="4"></td>

          <td><img src="../images/b12.gif" width="4" height="4"></td>
        </tr>
        <tr>
          <td background="../images/b1l.gif"><img src="../images/0.gif" width="4" height="2"></td>
          <td> <!-- начали наполнение ПЛАШКИ 2  -->
            <table border="0" cellpadding="2" cellspacing="0" width="182">
              <tr bgcolor="f7f7f7">
<td><table border=0 cellpadding="0" cellspacing="0" width="90%">
                <td><img src="../images/pnav.gif" width="19" height="17"></td><td width="90%" class="nm" align="center">Книга</td></tr></table>

               </td>
              </tr>
              <tr>
                <td class="small">
                   <img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../book/978546901373.html">О книге</a><br>
                   <img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../bookcont/978546901373.html">Содержание</a><br>
                   <img src="../images/li.gif" width="4" height="5" hspace="4" vspace="2"><a href="../bookchap/978546901373.html">Отрывок</a><br>
                </td>
              </tr>
             </table>
          </td><!-- закончили  наполнение ПЛАШКИ 3  -->
          <td background="../images/b1r.gif"><img src="../images/0.gif" width="4" height="2"></td>
        </tr>

        <tr>
          <td><img src="../images/b21.gif" width="4" height="4"></td>
          <td><img src="../images/bbot.gif" width="182" height="4"></td>
          <td><img src="../images/b22.gif" width="4" height="4"></td>
        </tr>
      </table>

         </td>
    </tr>

</table>
<!-- center part 3-col end -->
<!-- end part start -->
<table border="0" cellpadding="0" cellspacing="1" width="100%">
	<tr>
		<td colspan="2"><img src="../images/0.gif" width="1" height="1"></td>
	</tr>
	<tr>
		<td colspan="2" bgcolor="#696969"><img src="../images/0.gif" width="1" height="1"></td>
	</tr>
	<tr>

		<td colspan="2" bgcolor="#696969"><img src="../images/0.gif" width="1" height="1"></td>
	</tr>
    <tr>
       <td class="small" width="100%" valign="top"><a href="../publishing/index.html">издательство</a> | <a href="../index.html">каталог</a> | <a href="../sbit/index.html">отдел сбыта</a> | <a href="../feedback/index.html">обратная связь</a> | <a href="mailto:webmaster@piter.com">webmaster</a><br><img src="../images/0.gif" width="1" height="10"><br>

<br><img src="../images/bdt.gif" width="242" height="1" vspace="7"><br>
Авторские права охраняются.<br>
Воспроизведение материалов или их частей в любом виде без письменного разрешения запрещено!<br>
&copy; 1997-2004, <a href="http://www.piter.com/">Издательский дом "Питер"</a>
</td>
       <td width="190" class="small" align="right"><img src="../images/0.gif" width="160" height="1"><br>
       Санкт-Петербург<br>пр. Бол. Сампсониевский 29а<br>

тел. (812)-703-7374<br>
Москва<br>
тел. (095)-777-5467<br>
e-mail: <a href="mailto:sales@piter.com">sales@piter.com</a>, <a href="mailto:postbook@piter.com">postbook@piter.com</a>
<a href="http://www.piter.com">http://www.piter.com </a>
       </td>
    </tr>

</table>

</body>
</html>
<!-- end part end -->
